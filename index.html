<!DOCTYPE html>
<html>
<head>
  <title>Smart Ambulance - Fresh Test</title>
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>

<h2>ğŸš‘ Smart Ambulance System</h2>
<p id="status">Connecting...</p>
<div id="hospitalList"></div>

<script>
window.onload = async function () {

  const { createClient } = window.supabase;

  const supabase = createClient(
    "https://cfmxqwaopfahthflqgih.supabase.co",
    "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNmbXhxd2FvcGZhaHRoZmxxZ2loIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzIwNjg4NjEsImV4cCI6MjA4NzY0NDg2MX0.38jNHf-7UGhIelL87oWxB5eK0e5ZivfGSsyEv1C9pL0"
  );

  try {

    const { data, error } = await supabase
      .from("hospitals")
      .select("*");

    if (error) {
      document.getElementById("status").innerText =
        "Error: " + error.message;
      console.error(error);
      return;
    }

    document.getElementById("status").innerText =
      "âœ… Connected! Hospitals found: " + data.length;

    const list = document.getElementById("hospitalList");

    if (data.length === 0) {
      list.innerText = "No hospitals found.";
      return;
    }

    data.forEach(h => {
      const div = document.createElement("div");
      div.style.marginBottom = "10px";
      div.style.padding = "8px";
      div.style.border = "1px solid #ccc";

      div.innerText =
        "ğŸ¥ " + h.name +
        " | Beds: " + h.beds_available +
        " | Doctor: " + (h.doctor_available ? "Yes" : "No");

      list.appendChild(div);
    });

  } catch (err) {
    document.getElementById("status").innerText =
      "âŒ FETCH FAILED: " + err.message;
    console.error(err);
  }
};
</script>

</body>
</html>

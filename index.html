<!DOCTYPE html>
<html>
<body>

<button onclick="start()">START</button>
<button onclick="alertPolice()">ALERT</button>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
const supabaseClient = supabase.createClient(
  "https://inlkqessbewmxmtfvzfe.supabase.co",
  "YOUR_ANON_KEY"
);

function start() {
  navigator.geolocation.watchPosition(async pos => {
    const lat = pos.coords.latitude;
    const lng = pos.coords.longitude;

    const geo = await fetch(
      `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}`
    ).then(r=>r.json());

    const name =
      geo.address.city ||
      geo.address.town ||
      geo.address.village ||
      "Unknown";

    await supabaseClient.from("alerts").upsert({
      id: 1,
      location_name: name,
      latitude: lat,
      longitude: lng
    });
  });
}

async function alertPolice() {
  await supabaseClient.from("alerts")
    .update({ alert: true }).eq("id",1);
}
</script>

</body>
</html>

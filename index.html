<!DOCTYPE html>
<html>
<head>
  <title>Smart Ambulance - Hospital List</title>
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>

<h2>ğŸš‘ Smart Ambulance</h2>
<p id="status">Connecting...</p>
<div id="hospitalList"></div>

<script>
window.onload = async function () {

  const { createClient } = window.supabase;

  const supabase = createClient(
    "https://wrqwhykgnktfaaqiefjek.supabase.co",
    "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndycXdoeWtnbnRrZmFxaWVmamVrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjkwNzM3OTUsImV4cCI6MjA4NDY0OTc5NX0.t_GEclFobEHRhAhB2W6clKGxbEHKmjbslD0cLmalIMU"
  );

  try {

    const { data, error } = await supabase
      .from("hospitals")
      .select("*");

    if (error) {
      document.getElementById("status").innerText =
        "Error: " + error.message;
      console.error(error);
      return;
    }

    document.getElementById("status").innerText =
      "Connected! Hospitals found: " + data.length;

    if (data.length === 0) {
      document.getElementById("hospitalList").innerText =
        "No hospitals in database.";
      return;
    }

    const list = document.getElementById("hospitalList");

    data.forEach(h => {
      const div = document.createElement("div");
      div.style.marginBottom = "10px";
      div.innerText =
        "ğŸ¥ " + h.name +
        " | Beds: " + h.beds_available +
        " | Doctor: " + (h.doctor_available ? "Yes" : "No");

      list.appendChild(div);
    });

  } catch (err) {
    document.getElementById("status").innerText =
      "FETCH FAILED: " + err.message;
    console.error(err);
  }
};
</script>

</body>
</html>

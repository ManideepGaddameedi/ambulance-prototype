<!DOCTYPE html>
<html>
<head>
  <title>Smart Ambulance - Supabase Test</title>
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>

<h2>ðŸš‘ Smart Ambulance Panel</h2>

<p id="status">Connecting to Supabase...</p>
<div id="hospitalList"></div>

<script>
window.onload = async function() {

  if (!window.supabase) {
    document.getElementById("status").innerText =
      "Supabase library not loaded!";
    return;
  }

  const { createClient } = window.supabase;

  const client = createClient(
    "https://inlkqessbewmxmtfvzfe.supabase.co",
    "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndycXdoeWtnbnRrZmFxaWVmamVrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjkwNzM3OTUsImV4cCI6MjA4NDY0OTc5NX0.t_GEclFobEHRhAhB2W6clKGxbEHKmjbslD0cLmalIMU"
  );

  try {
    const { data, error } = await client
      .from("hospitals")
      .select("*");

    if (error) {
      document.getElementById("status").innerText =
        "ERROR: " + error.message;
      console.error(error);
      return;
    }

    document.getElementById("status").innerText =
      "Connected! Hospitals found: " + data.length;

    if (data.length === 0) {
      document.getElementById("hospitalList").innerText =
        "No hospitals found in database.";
      return;
    }

    let list = document.getElementById("hospitalList");
    list.innerHTML = "<h3>Hospital List:</h3>";

    data.forEach(h => {
      let div = document.createElement("div");
      div.innerText =
        h.name +
        " | Beds: " + h.beds_available +
        " | Doctor: " + (h.doctor_available ? "Yes" : "No");

      list.appendChild(div);
    });

  } catch (err) {
    document.getElementById("status").innerText =
      "FETCH FAILED: " + err.message;
    console.error(err);
  }
};
</script>

</body>
</html>

<!DOCTYPE html>
<html>
<head>
<title>Hospital Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
</head>
<body>

<h2>ğŸ¥ Hospital Panel</h2>

Beds: <input type="number" id="beds"><br><br>
Doctors: <input type="number" id="doctors"><br><br>

<button onclick="updateAvailability()">Update Availability</button>

<div id="liveLocation"></div>

<script>

const supabase = window.supabase.createClient(
  "YOUR_SUPABASE_URL",
  "YOUR_ANON_KEY"
);

let hospitalId = 1; // change if needed

async function updateAvailability(){

  let beds = document.getElementById("beds").value;
  let doctors = document.getElementById("doctors").value;

  await supabase
  .from("hospitals")
  .update({
    available_beds:beds,
    available_doctors:doctors
  })
  .eq("id", hospitalId);

  alert("Availability Updated");
}

supabase
.channel('live-location')
.on('postgres_changes',{
  event:'UPDATE',
  schema:'public',
  table:'ambulance_location'
}, payload=>{
  document.getElementById("liveLocation").innerHTML =
  `Ambulance Location: ${payload.new.lat}, ${payload.new.lng}`;
})
.subscribe();

supabase
.channel('hospital-alert')
.on('postgres_changes',{
  event:'UPDATE',
  schema:'public',
  table:'emergency_alerts'
}, payload=>{
  if(payload.new.hospital_id == hospitalId){
    alert("ğŸš¨ Emergency Assigned To Your Hospital!");
  }
})
.subscribe();

</script>
</body>
</html>

<!DOCTYPE html>
<html>
<head>
  <title>Police Control</title>
  <link rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
</head>
<body>

<h2>ðŸš¦ Police Control</h2>
<div id="map" style="height:400px;"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
const supabaseClient = supabase.createClient(
  "https://inlkqessbewmxmtfvzfe.supabase.co",
  "YOUR_ANON_KEY_HERE"
);

const map = L.map("map").setView([17, 78], 6);
L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png")
  .addTo(map);

let marker = null;

async function loadLocation() {
  const { data } = await supabaseClient
    .from("alerts")
    .select("*")
    .eq("id", 1)
    .single();

  if (!data) return;

  if (data.latitude && data.longitude) {
    const pos = [data.latitude, data.longitude];

    if (!marker) {
      marker = L.marker(pos).addTo(map);
      map.setView(pos, 15);
    } else {
      marker.setLatLng(pos);
    }
  }
}

setInterval(loadLocation, 2000);
</script>

</body>
</html>

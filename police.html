<!DOCTYPE html>
<html>
<head>
  <title>Traffic Police Dashboard</title>
</head>
<body>

<h1>ðŸš¦ Traffic Police Dashboard</h1>

<p>
Junction: <span id="j"></span><br>
Direction: <span id="d"></span><br>
Time: <span id="t"></span>
</p>

<iframe
  id="map"
  width="100%"
  height="400"
  style="border:0;"
  loading="lazy">
</iframe>

<script>
let lastLat = null;
let lastLon = null;

function updateMap() {

  document.getElementById("j").innerText =
    localStorage.getItem("junction");

  document.getElementById("d").innerText =
    localStorage.getItem("direction");

  document.getElementById("t").innerText =
    localStorage.getItem("time");

  var lat = localStorage.getItem("lat");
  var lon = localStorage.getItem("lon");

  // âœ… Only update map if location changed
  if (lat && lon && (lat !== lastLat || lon !== lastLon)) {

    document.getElementById("map").src =
      "https://www.google.com/maps?q="
      + lat + "," + lon + "&z=16&output=embed";

    lastLat = lat;
    lastLon = lon;
  }
}

// Check every 1 second, but reload map ONLY if needed
setInterval(updateMap, 1000);
</script>

</body>
</html>
